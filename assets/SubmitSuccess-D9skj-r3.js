import{_ as I,i as v,g as s,w as o,r as a,o as e,a as u,b as l,c as E,t as c,f as m,F as y}from"./index-Cm55Gr8Q.js";const x={name:"MerchantSubmitSuccess",data(){return{status:null,activeStep:0,currentStatusText:"正在获取订单状态",deliveryId:null,intervalId:null,countdown:5,isLoading:!0}},mounted(){const i=new URLSearchParams(window.location.search);this.deliveryId=i.get("delivery_id"),this.deliveryId?(this.fetchOrderStatus(),this.startPolling()):(this.status="ORDER_NOT_FOUND",this.deliveryId="未知",this.currentStatusText="订单号未提供",this.isLoading=!1)},beforeUnmount(){this.clearPolling()},methods:{async fetchOrderStatus(){try{const i=await v.get("https://delivery-prod-api.xiaohuangxi.studio/api/DeliveryService/getDeliveryStatus",{params:{delivery_id:this.deliveryId}});i.data.code===200?(this.status=i.data.data.status,this.updateStatusDisplay()):(this.status="ORDER_NOT_FOUND",this.currentStatusText="订单不存在",this.clearPolling())}catch(i){console.error("请求失败:",i),this.status="ORDER_NOT_FOUND",this.currentStatusText="订单不存在",this.clearPolling()}finally{this.isLoading=!1}},updateStatusDisplay(){this.status==="WAITING_REVIEW"?(this.activeStep=1,this.currentStatusText="信息审核中，如等待时间过长，可以直接联系负责人进行审核"):this.status==="REVIEW_SUCCESS"?(this.activeStep=2,this.currentStatusText="审核通过"):this.status==="REVIEW_FAIL"?(this.activeStep=2,this.currentStatusText="审核未通过"):this.status==="IN_DELIVERY"?(this.activeStep=2,this.currentStatusText="正在配送"):this.status==="DELIVERED"?(this.activeStep=2,this.currentStatusText="配送成功"):this.status==="CANCEL"?(this.activeStep=0,this.currentStatusText="订单已取消"):(this.status="ORDER_NOT_FOUND",this.currentStatusText="订单不存在")},startPolling(){this.intervalId=setInterval(()=>{this.fetchOrderStatus(),this.countdown=11},1e4),setInterval(()=>{this.countdown>0&&this.countdown--},1e3)},clearPolling(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}}},g={style:{"white-space":"nowrap"}};function D(i,r,R,T,t,w){const d=a("el-header"),h=a("el-skeleton"),n=a("el-result"),_=a("el-col"),p=a("el-card"),S=a("el-main"),f=a("el-container");return e(),s(f,null,{default:o(()=>[u(d,{height:"60px",class:"navbar"},{default:o(()=>r[0]||(r[0]=[l("div",{class:"navbar-left"},[l("span",{class:"title"},"配送订单状态")],-1)])),_:1}),u(S,{style:{width:"100%",display:"flex","flex-direction":"column","align-items":"center","text-align":"center"}},{default:o(()=>[t.isLoading?(e(),s(h,{key:0,rows:15,animated:""})):(e(),E(y,{key:1},[u(_,{sm:12,lg:6},{default:o(()=>[t.status==="WAITING_REVIEW"?(e(),s(n,{key:0,icon:"info",title:"配送信息已提交","sub-title":`信息审核中，页面会在 ${t.countdown} 秒后自动刷新`},null,8,["sub-title"])):t.status==="REVIEW_SUCCESS"?(e(),s(n,{key:1,icon:"success",title:"订单通过审核","sub-title":"恭喜您，订单通过审核，即将分配配送员"})):t.status==="REVIEW_FAIL"?(e(),s(n,{key:2,icon:"warning",title:"订单审核未通过","sub-title":"该订单审核未通过，详情请联系支持团队"})):t.status==="IN_DELIVERY"?(e(),s(n,{key:3,icon:"info",title:"正在配送中","sub-title":"配送正在进行中，请耐心等待"})):t.status==="DELIVERED"?(e(),s(n,{key:4,icon:"success",title:"配送已完成","sub-title":"您的订单已成功送达"})):t.status==="CANCEL"?(e(),s(n,{key:5,icon:"warning",title:"订单已取消","sub-title":"该订单已被取消，详情请联系支持团队"})):(e(),s(n,{key:6,icon:"error",title:"订单不存在","sub-title":"请检查订单号是否正确。"}))]),_:1}),u(p,{style:{"max-width":"480px","margin-top":"20px"}},{default:o(()=>[l("p",null,[r[1]||(r[1]=l("strong",null,"订单号：",-1)),l("span",g,c(t.deliveryId),1)]),l("p",null,[r[2]||(r[2]=l("strong",null,"当前状态：",-1)),m(" "+c(t.currentStatusText),1)])]),_:1})],64))]),_:1})]),_:1})}const b=I(x,[["render",D],["__scopeId","data-v-eb8b7a4d"]]);export{b as default};
